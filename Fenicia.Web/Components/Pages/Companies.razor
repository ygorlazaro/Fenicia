@page "/companies"
@using Fenicia.Auth.Domains.Company.Logic

@inject Fenicia.Web.Providers.Auth.CompanyProvider CompanyProvider

<PageTitle>Companies</PageTitle>

<h3>Companies</h3>

@if (_isLoading)
{
    <p>Loading companies...</p>
}
else if (_loadError is not null)
{
    <p class="text-danger">Error loading companies: @_loadError</p>
}
else if (_companies is null || !_companies.Any())
{
    <p>No companies found.</p>
}
else
{
    <ul>
        @foreach (var company in _companies)
        {
            <li>@company.Name</li>
        }
    </ul>
}

@code {
    private IEnumerable<CompanyResponse>? _companies;
    private bool _isLoading = true;
    private string? _loadError;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            _companies = await CompanyProvider.GetCompaniesAsync();
        }
        catch (Exception ex)
        {
            _loadError = ex.Message;
        }
        finally
        {
            _isLoading = false;
        }
    }
}
